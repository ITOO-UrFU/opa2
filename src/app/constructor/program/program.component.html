<div class="header">
	<h1>
	{{ program?.title }}
	</h1>
<div>
	<a (click)="step()">Назад</a>
	<a (click)="step()">Start</a>
	<a (click)="step()">Вперед</a>
</div>
<div *ngIf="steps.modules">
	<div *ngIf="program?.targets" id="targets">
		<ul class="target_choices">
			<ng-template ngFor let-target [ngForOf]="program?.targets">
				<li (click)="selectTarget(target?.id)" [class.selected]="selected == target?.id">{{ target?.title }}</li>
			</ng-template>
		</ul>
	</div>
	<div *ngIf="build">
	<div id="competences">
		<ul>
			<ng-template ngFor let-competence [ngForOf]="program?.competences">
				<li>{{ competence?.title }} <em>{{ competences[competence.id] }}</em> %</li>
			</ng-template>
		</ul>
	</div>
		<h2> {{ program.targets_by_id[selected]?.title }}</h2>
		<ng-template ngFor let-choiceGroup [ngForOf]="program.targets_by_id[selected]?.choice_groups" >
		<div class="build">
			<h3>{{ program.choice_groups_by_id[choiceGroup].title }} {{ program.choice_groups_by_id[choiceGroup].labor }} з.е. выбрано: <span [class.alert]="modules[choiceGroup].labor_selected > modules[choiceGroup].labor">{{modules[choiceGroup].labor_selected}} з.е.</span></h3>
			
				<ul class="left">
					<ng-template ngFor let-module [ngForOf]="program.choice_groups_by_id[choiceGroup].get_program_modules">
					<li *ngIf = "modules[choiceGroup].default.indexOf(module)!=-1" (click)="toggle(module, choiceGroup, 'default')">
						<hr>
						{{ program.modules_by_id[module].title  }} {{ program.modules_by_id[module].get_labor }} з.е.
						<ol>
						<ng-template ngFor let-discipline [ngForOf]="program.modules_by_id[module].disciplines" >
							<li><em discipline [discipline]="discipline"></em><span>{{discipline.labor}} з.е.</span></li>
						</ng-template>
						</ol>
						<hr>
					</li>
			
					</ng-template>
				</ul>
				<ul class="right">
					<ng-template ngFor let-module [ngForOf]="program.choice_groups_by_id[choiceGroup].get_program_modules">
					<li *ngIf = "modules[choiceGroup].variative.indexOf(module)!=-1" (click)="toggle(module, choiceGroup, 'variative')">
						<hr>
						{{ program.modules_by_id[module].title }} {{ program.modules_by_id[module].get_labor }} з.е.
						<ol>
						<ng-template ngFor let-discipline [ngForOf]="program.modules_by_id[module].disciplines" >
							<li><em discipline [discipline]="discipline"></em><span>{{discipline.labor}} з.е.</span></li>
						</ng-template>
						</ol>
						<hr>
					</li>
					</ng-template>
				</ul>
				
		</div>
		</ng-template>
	</div>
	<!--<div *ngIf="program?.targets">
		<h2> {{ program?.targets_by_id[trajectory.target_id]?.title }}</h2>
		<ul>
		<ng-template ngFor let-choiceGroup [ngForOf]="program?.targets_by_id[trajectory?.target_id]?.choice_groups" >
			<h3>Группа: {{ program?.choice_groups_by_id[choiceGroup]?.title }} ___ из {{ program?.choice_groups_by_id[choiceGroup]?.labor }} з.e</h3>
			<ng-template ngFor let-module [ngForOf]="program?.choice_groups_by_id[choiceGroup]?.get_program_modules">
				<li class="module_title"><span class="is_selected" *ngIf="program?.modules_by_id[module]?.targets_positions_indexed[trajectory.target_id] == 1">[x]</span>
				<span *ngIf="program?.modules_by_id[module]?.targets_positions_indexed[trajectory.target_id] == 2">[ ]</span>
					{{ program?.modules_by_id[module]?.title }} - <span class="labor_display">{{ program?.modules_by_id[module]?.get_labor }} з.е.</span></li>
					<div class="disciplines">
						<ng-template ngFor let-discipline [ngForOf]="program?.modules_by_id[module]?.disciplines" >
							<p> - <em discipline [discipline]="discipline"></em><span class="labor_display">{{discipline.labor}} з.е.</span></p>
						</ng-template>
					</div>
			</ng-template>
		</ng-template>
		</ul>
	</div>-->
</div>

<div *ngIf="steps.disciplines">
		<h2> Дисциплины </h2>
		
		<div *ngIf="build" class="build">
		<table width="100%" border="1">
		<ng-template ngFor let-choiceGroup [ngForOf]="program.targets_by_id[selected]?.choice_groups" >
		
				
				<ng-template ngFor let-module [ngForOf]="program.choice_groups_by_id[choiceGroup].get_program_modules">
					<ng-template [ngIf] = "modules[choiceGroup].default.indexOf(module)!=-1">
						<ng-template ngFor let-discipline [ngForOf]="program.modules_by_id[module].disciplines" >
						<tr>
							<td>
								<em discipline [discipline]="discipline"></em>
							</td>
							<ng-template ngFor let-semester [ngForOf]="[1,2,3,4,5,6,7,8]" >
							<td>
								<ng-template ngFor let-variant [ngForOf]="program.variants[discipline.id]" >
									<ng-template [ngIf]="variant.course"><div>Онлайн-курс</div></ng-template>
									<ng-template [ngIf]="variant.parity == 1 || variant.parity == 2 ">
									<div [ngSwitch]="semester%variant.parity">
											<div *ngSwitchCase="0"> Осень </div>
											<div *ngSwitchCase="1"> Весна </div>
									</div>
									</ng-template>
									<ng-template [ngIf]="variant.parity == 3 ">
										<div> Когда хошь </div>
									</ng-template>
									<ng-template [ngIf]="variant.semester">
										<div [ngSwitch]="variant.semester.training_semester - semester">
											<div *ngSwitchCase="0">{{variant.semester.term}} </div>
										</div>
									</ng-template>
								</ng-template>
							</td>
							</ng-template>
						</tr>
						</ng-template>
					</ng-template>
				</ng-template>
		
				
		</ng-template>
		</table>

		</div>
	</div>
</div>
